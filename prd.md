# 产品需求文档 (PRD) - PromptSnap v0.1 (MVP)

| 项目 | 内容 |
| :--- | :--- |
| **产品名称** | PromptSnap |
| **产品类型** | Chrome 浏览器扩展 (Extension) |
| **核心交互** | 侧边抽屉 (Sidebar) + 悬浮球 |
| **当前阶段** | MVP (最小可行性产品) |
| **目标平台** | **Google Gemini** (主要), 架构预留 ChatGPT 支持 |
| **核心目标** | 在 Gemini 界面通过侧边栏一键填入预设 Prompt，解决重复输入痛点。 |

---

## 1. 产品背景与价值
**痛点**：用户在与 AI (特别是 Gemini) 交互时，高频使用固定指令（如“请解释代码”、“翻译成英文”、“润色文案”）。手动输入或从记事本复制粘贴效率低下。
**价值**：在浏览器当前页面通过侧边栏“即点即用”，极大提升交互效率。

---

## 2. 用户流程 (User Flow)
1.  用户打开 `gemini.google.com`。
2.  页面显示半透明悬浮球（默认右下侧）。
3.  点击悬浮球，右侧滑出 PromptSnap 侧边栏。
4.  侧边栏默认展示 2-3 条预置 Prompt（首次使用）。
5.  用户点击某条 Prompt。
6.  **核心动作**：Gemini 输入框自动填入文字，并触发输入事件（确保发送按钮变亮）。

---

## 3. 功能需求详情 (Functional Requirements)

### 3.1. 唤起与交互 (Toggle & UI)
*   **悬浮球 (Floating Action Button)**：
    *   **位置**：默认位于页面右侧边缘中部。
    *   **拖拽**：**支持垂直拖拽**，防止遮挡 Gemini 界面元素。
    *   **样式**：轻量级设计，半透明，Hover 时高亮。
*   **侧边栏 (Sidebar)**：
    *   点击悬浮球 -> 侧边栏从右向左滑出。
    *   点击“X”或页面遮罩 -> 收起。
    *   **快捷键**：`Alt + S` 切换显示/隐藏。

### 3.2. Prompt 列表管理 (CRUD)
*   **列表展示**：
    *   **标题**：加粗显示。
    *   **预览**：单行截断，显示前 20 字。
    *   **操作**：每行包含 [填入]、[编辑]、[删除] 按钮。
*   **新增/编辑 Prompt**：
    *   点击“+ 新建”或“编辑图标”，进入表单模式。
    *   **字段**：标题 (Title)、内容 (Content, 多行文本域)。
    *   **保存**：校验非空后保存至 `chrome.storage.local`。
*   **初始化 (Onboarding)**：
    *   检测到用户首次安装（storage 为空）时，**自动写入 3 条预置数据**：
        1.  *代码解释*："请解释这段代码的逻辑和潜在的 bug："
        2.  *英文润色*："请将以下内容翻译成地道的英文，风格商务："
        3.  *简单总结*："请用一句话总结上述内容。"

### 3.3. 核心功能：智能填入 (Smart Snap)
*   **目标元素定位**：
    *   针对 Gemini 网页结构，精准定位输入框容器（通常是 `contenteditable` 的 `div` 或 `rich-textarea`）。
    *   *注：Gemini 的 DOM 结构可能会变，需保持选择器的灵活性。*
*   **模拟输入 (Critical)**：
    *   不仅是修改 DOM 的 `innerText`。
    *   **必须触发 Input 事件**：执行 `input`, `change`, 或 `textInput` 事件分发，确保 Gemini 的前端框架（Angular/Lit/React等）能够感知数据变化，从而激活“发送”按钮。
    *   **光标处理**：填入后，将光标移动到文本末尾，方便用户继续补充内容。

---

## 4. 技术与非功能需求

| 需求项 | 说明 |
| :--- | :--- |
| **Manifest版本** | Manifest V3 |
| **权限控制** | `storage` (存储数据), `activeTab` 或 `scripting` (操作网页) |
| **Host Permissions** | `https://gemini.google.com/*` (MVP 严格限制范围) |
| **数据隐私** | 所有 Prompt 数据仅存储在用户本地浏览器 (`local storage`)，不上传云端。 |

---

## 5. 界面原型示意

```text
+-------------------------------------------------------+
| 网页主体 (Gemini.google.com)                          |
|                                                       |
|                                     +-----------------+
|                                     | PromptSnap    X |
|                                     +-----------------+
|   Gemini 回答区域...                 | [+ 新建]        |
|                                     +-----------------+
|                                     | [P] 代码解释     | <- [P]是编辑图标
|                                     | 解释代码逻辑...   |
|                                     | [填入]   [删除]  |
|                                     +-----------------+
|                                     | [P] 英文润色     |
|                                     | 请翻译成...      |
|                                     | [填入]   [删除]  |
|                                     +-----------------+
|                                     |                 |
| 输入框: [ 这里的字是自动填进去的 ]      |                 |
+-------------------------------------------------------+
```